defaults:
  - environment: cvrp
  - networks: cvrp
  - memory: cvrp
  - validation: config_validate_cvrp
  - slowrl: config_slowrl_cvrp


algo_name: memo # poppy_indep #"pomo" # purely descriptive
env_name: "cvrp" # purely descriptive
subdir_tag: "" # purely descriptive

seed: 0
num_devices: -1

num_steps: 4550000 
batch_size: 32 # check it's divisible by num_devices if needed.
pop_size: 1
num_starting_positions: -1
num_jit_steps: 1
use_half_precision: False

init_mem_mha_scale: 0.1
budget: 200 

loss:
  type: "LRMI" # "max_improvement", "LRMI" (log-rectified max improvement loss), "POMO"
  sp_spec: false  
  weight_offset: 1e-7
  weight_scale: 10
  
checkpoint_freq: 1000
checkpointing:
  directory: "checkpoints/"
  checkpoint_fname_load: "pomo_100"
  checkpoint_fname_save: "checkpoint"
  save_checkpoint: True
  keep_best_checkpoint: False
  overwrite_checkpoints: True
  restore_path: "data/memento/checkpoints/cvrp"  # Path to a checkpoint to be loaded (False -> do not load anything)
  restore_encoder: True  # Whether to load the encoder from the checkpoint
  restore_decoder: True  # Whether to load the decoder(s) from the checkpoint
  allow_cloned_across_population: True  # Whether to clone the decoders
  restore_optimizer: False  # Whether to load the optimizer from the checkpoint

rollout:
  policy:
    temperature: 1

use_poppy_objective: False

optimizer:
  encoder:
    lr: 1e-4
    l2_regularization: 1e-6
  decoder:
    lr: 1e-4
    l2_regularization: 0
  memory:
    lr: 4e-3 # 1e-2
    l2_regularization: 0
  num_gradient_accumulation_steps: ${budget}

validation_freq: 1000 

logger:
  terminal:
    label: ''
    time_delta: 1
  neptune:
    name: 'MEMENTO'
